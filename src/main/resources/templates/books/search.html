<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
<head>
  <meta charset="UTF-8">
  <title>Books - Search</title>
  <script type="text/javascript" th:src="@{../javascript/books-search.js}"></script>
  <link rel="stylesheet" th:href="@{../CSS/books-search.css}">
  <link th:href="@{/css/bootstrap.css}" rel="stylesheet" />
  <link th:href="@{/css/collectors-corner.css}" rel="stylesheet" />
<!--  <script type="text/javascript" th:src="@{/javascript/bootstrap.js}"></script>-->
</head>


<div th:replace="fragments :: page-header"></div>

<body class="container body-content">

<p th:text="${collectionIdsAndBooks}" id="collectionIdsAndBooks" hidden></p>

<form>
  <input type="text" id="userSearchTerm">
  <select id="searchTypeDropdown" style="height:26px;">
    <option value="title">Title</option>
    <option value="author">Author</option>
    <option value="isbn">ISBN</option>
  </select>
  <button type="button" id="searchTermAndType">Search</button>
</form> <hr>

<button id="newSearchButton"><a href="http://localhost:8080/books/search" style="color:inherit;">New Search</a></button> <br>
<button id="showFiltersButton" style="display:none" onclick="toggleShowHideFilters(); generateAuthorCheckboxHTML(); generateGenreCheckboxHTML(); toggleCheckUncheckAuthorBoxes(); toggleCheckUncheckGenreBoxes">Show Filters</button>

<div id="filtersSection" style="display:none;"> <br> <hr>

  <form id="yearFilters" >
    <h3>Year Range:</h3>
    <input type="number" id="userYearMin">
    <input type="number" id="userYearMax">
  </form>
  <button id="filterYearsButton" onclick="filterYears(userYearMin, userYearMax); generateAuthorCheckboxHTML(); generateGenreCheckboxHTML(); ">Filter Years</button> <br> <br> <hr>

  <form id="authorFilters">
    <h3>Author:</h3>
    <div id="authorCheckboxes"></div>
  </form>
  <button id="filterAuthorsButton" onclick="showOrHideRowsBasedOnAuthorCheckboxFilters(); generateGenreCheckboxHTML()">Filter Authors</button>
  <button id="selectAllAuthorsButton" onclick="toggleCheckUncheckAuthorBoxes()">Select All</button>
  <button id="unselectAllAuthorsButton" onclick="toggleCheckUncheckAuthorBoxes()">Unselect All</button> <br> <br> <hr>

  <form id="genreFilters">
    <h3>Genre:</h3>
    <div id="genreCheckboxes"></div>
  </form>
  <button id="filterGenresButton" onclick="showOrHideRowsBasedOnGenreCheckboxFilters(); generateAuthorCheckboxHTML()">Filter Genres</button>
  <button id="selectAllGenresButton" onclick="toggleCheckUncheckGenreBoxes()">Select All</button>
  <button id="unselectAllGenresButton" onclick="toggleCheckUncheckGenreBoxes()">Unselect All</button> <br> <br> <hr>

</div>



<!-- Handles the dropdown search options (title, author, isbn) -->
<script>
const searchTermAndType = document.getElementById('searchTermAndType');
const searchTypeDropdown = document.getElementById('searchTypeDropdown');

searchTermAndType.addEventListener('click', function() {

  const searchTerm = searchTypeDropdown.value;

  if (searchTerm === 'title') {
        searchTitle();
  } else if (searchTerm === 'author') {
        searchAuthor();
  } else if (searchTerm === 'isbn') {
        searchIsbn();
  }
});
</script>

<form method="post" id="databaseInformation" hidden>
  <input th:field="${book.title}" id="titleSubmission">
  <input th:field="${book.dateAdded}" id="dateSubmission">
  <input th:field="${book.genre}" id="genreSubmission">
  <input th:field="${book.author}" id="authorSubmission">
  <input th:field="${book.year}" id="yearSubmission">
  <input th:field="${book.synopsis}" id="synopsisSubmission">
  <input type="text" name="collectionId" id="collectionId">
</form>

<h3 id="collectionNameDropdownLabel">User Collection:</h3><br>
<form>
  <select id="collectionNamesDropdown">
    <option value="">Select a collection</option>
    <th:block th:each="collection : ${bookCollections}">
        <span th:if="${collection.user.id == cookie}">
            <option th:text="${collection.name}" th:value="${collection.id}" ></option>
        </span>
    </th:block>
  </select>
</form>

<div id="resultsTable"></div>

</body>

</html>